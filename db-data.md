### Таблицы пользователей

#### Users  
Таблица с информацией о всех пользователях.

id - уникальный идентификатор пользователя  
username - логин на платформе  
first_name - имя  
last_name - фамилия  
is_active - активирован ли аккаунт  
date_joined - дата и время регистрации  
email - почта  
referal_user - пользователь, который его пригласил (реферал)  
company_id - идентификатор компании (FK - Company)  
tier - ранг на платформе  
score - количество очков опыта на платформе  

#### UserEntry  
В этой таблице фиксируются заходы пользователя на платформу - когда, в какое время и на какую страницу пользователь зашел первый раз за сутки.  
Важно: Фиксируется только первый вход в каждые сутки для одного пользователя!

id - уникальный идентификатор  
entry_at - дата и время входа на платформу  
page_id - идентификатор страницы входа (FK - Page)  
user_id - идентификатор пользователя (FK - Users)  



### Таблицы общего характера  

#### Page  
Таблица с информацией обо всех страницах сайта.  

id - уникальный идентификатор страницы сайта  
path - относительный URL-адрес  
name - имя страницы  
title - тайтл страницы (для поисковиков)  
description - дескрипшен страницы (для поисковиков)  
keywords - ключевые слова (для поисковиков, разделены запятой)  


####  Company
Таблица с информацией о компаниях.  

id - уникальный идентификатор компании  
name - название компании  
description - описание компании  
logo - логотип компании (путь до файла на сервере)  
db_cred - информация о схеме БД для обработки кода  
site - ссылка на сайт  
welcome_bonus - приветственный бонус всем студентам этой компании при регистрации в CodeCoins  



### Таблицы, связанные с задачами

#### Language
Таблица с языками, на которых можно решать задачи на платформе.  

id - уникальный идентификатор языка  
name - название языка  

#### Problem 
Таблица с перечнем задач.  

id - уникальный идентификатор задачи  
name - название задачи  
complexity - сложность задачи (1-3)  
bonus - бонус за правильное решение (в CodeCoins)  
task - формулировка задания  
solution - формулировка решения  
cost - стоимость задачи (в CodeCoins)  
rating - рейтинг задачи   
page_id - идентификатор страницы сайта (FK - Page)  
solution_cost - стоимость решения (в CodeCoins)  
priority - приоритет отображения в списке задач  
company_id - идентификатор компании (FK - Company) (не используется)  
is_visible - отображать в общем списке задач?  
is_private - доступно только для корпоративных клиентов?  
recommendation - рекомендации по решению задачи  


#### LanguageToProblem
Таблица-связка, в которой хранится информация о всех языках, с помощью которых можно решить каждую из задач.  

Одна строка таблицы = 1 связка «задача-язык». Если задачу можно решить на 5 языках, то будет 5 строк.  

ltp_id - уникальный идентификатор записи  
pr_id - идентификатор задачи (FK - Problem)  
lang_id - идентификатор языка (FK - Language)  

#### CodeRun  

Таблица, куда попадает информация, когда пользователь решает задачу и нажимает кнопку Выполнить.  

Эта таблица содержит ответ на вопросы:  

Что за пользователь?  
Во сколько он отправил его на выполнение?  
На каком языке написан код?  
Какую задачу пользователь решал?   


id - идентификатор выполнения кода  
created_at - дата и время выполнения кода  
problem_id - идентификатор задачи (FK - Problem)  
user_id - идентификатор пользователя (FK - Users)  
language_id - идентификатор языка (FK - Language)  

#### CodeSubmit
Таблица, куда попадает информация, когда пользователь решает задачу и нажимает кнопку Проверить - отправляет код на проверку.  

Эта таблица содержит ответ на вопросы:  

Какой код написал пользователь?  
Во сколько он отправил его на проверку?  
На каком языке написан код?  
Какую задачу пользователь решал?   
Что за пользователь?  
Увенчалась ли его попытка успехом?  
Сколько времени выполнялся его код?  

id - уникальный идентификатор проверки кода  
created_at - дата и время проверки кода  
code - код, написанный пользователем  
problem_id - идентификатор задачи (FK - Problem)  
user_id - идентификатор пользователя (FK - Users)  
is_false - правильная или неправильная попытка  
time_spent - потрачено времени на попытку  
language_id - идентификатор языка (FK - Language)  


#### Problem_To_Company
В этой таблице описаны домашние задания для компаний - корпоративных клиентов.   
В каждой строке таблицы прописывается задача из общего списка задач (Problem) и для какого корпоративного клиента (Company) она является домашним заданием.  
Для разных корпоративных клиентов одна и та же задача может быть домашней. При этом у нее могут быть разные name, task, cost и прочие поля для каждого клиента.  
Если name, task, cost и прочие поля стоят NULL, то значения берутся по умолчанию из таблицы Problem.  
Для каждого клиента может быть описано разное количество домашних задач - для кого-то 10, а для кого-то 100.  

id - уникальный идентификатор записи  
name - название данной задачи для конкретного КК  
task - формулировка данной задачи для конкретного КК  
cost - стоимость данной задачи для конкретного КК 
company_id - идентификатор компании-клиента (FK - Company)  
problem_id - идентификатор задачи (FK - Problem)  
bonus - бонус за правильное решение данной задачи для конкретного КК  
priority - приоритет отображения задачи в общем списке для конкретного КК  


### Таблицы, связанные с тестами

#### Test

Таблица с общей информацией о тестах на платформе.  

id - уникальный идентификатор теста  
name - название теста  
page_id - идентификатор страницы сайта (FK - Page)  
cost - стоимость теста в CodeCoins  
cover - обложка теста (путь до картинки на сервере)  
intro - текст-введение к тесту  
result - текст с результатами (в зависимости от набранных баллов, 3 варианта, разделенных запятой)  
complexity - сложность (1, 2, 3)  
priority - приоритет для отображения на сайте  
company_id - «доступно только для компании №» (не используется)  
is_visible - отображать в списке тестов  
is_private - приватный тест или нет  
repeat_cost - стоимость повторного прохождения в CodeCoins  


#### TestQuestion
Таблица с перечнем всех вопросов ко всем тестам.  

id - уникальный идентификатор вопроса  
question_num - номер вопроса в конкретном тесте (например, всего в тесте 10 вопросов, а этот - 7)  
value - сам вопрос  
tag - основная тема вопроса  
test_id - идентификатор теста (FK - Test)  
explanation - объяснение вопроса  
explanation_cost - стоимость объяснения в CodeCoins  
type_question - тип вопроса (с выбором ответа, с множественным выбором, с вводом правильного ответа)  

#### TestAnswer
Таблица с перечнем всех ответов ко всем вопросам всех тестов.  

id - уникальный идентификатор ответа на вопрос теста  
option - номер варианта для конкретного вопроса (обычно от 1 до 4)  
value - ответ  
is_correct - правильный/не правильный  
question_id - идентификатор вопроса (FK - TestQuestion)  

#### TestStart
Сюда попадают данные, когда человек нажимает «Начать тест».  

id - уникальный идентификатор начала теста  
created_at - дата и время начала теста  
test_id - какой тест начал  
user_id - кто начал  

#### TestResult 
Сюда попадают данные, когда человек закончил тест сам или у него закончилось время.  

Важно:  
Обратите внимание, что для одного теста в таблицу делается столько записей, сколько вопросов в тесте. Т.е. 1 строка = 1 вопрос 1 теста.  
Обратите внимание, что не везде указан answer_id - иногда пользователь пропускает вопросы и не выбирает ни один из вариантов.  

Описание:  
id - уникальный идентификатор результата  
created_at - дата и время ответа на вопрос  
answer_id - идентификатор ответа (FK - TestAnswer)  
question_id - идентификатор вопроса (FK - TestQuestion)  
test_id - идентификатор теста (FK - Test)  
user_id - идентификатор пользователя (FK - Users)  
value - значение (если пользователь вводил ответ вручную)  



### Таблицы про транзакции

#### TransactionType
Таблица с основными типами транзакций. Транзакция на платформе - любое действие, связанное с CodeCoins.   

Тип «списание» имеют записи с ID: 1, 23-28  
Тип «начисление» имеют записи с ID: 2-22, 29  
Тип с ID 30 (Покупка за рубли) можно игнорировать, он нигде не встречается.  

Описание столбцов:   

type - идентификатор типа транзакции  
description - описание  
value - количество CodeCoins по умолчанию, соответствующее данному типу транзакции  



#### Transaction
В этой таблице хранится информация обо всех транзакциях, совершенных всеми пользователями на платформе. Любое движение монет (начисление или списание CodeCoins) отражено в этой таблице.  

id - уникальный идентификатор транзакции  
created_at - дата и время транзакции  
value - сумма транзакции (в CodeCoins)  
type_id - тип транзакции (FK - TransactionType)  
user_id - пользователь (FK - Users)  
